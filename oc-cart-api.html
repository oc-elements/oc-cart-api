<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../iron-ajax/iron-ajax.html">
<link rel="import" href="../oc-core-utils/oc-core-utils.html">

<dom-module id="oc-cart-api">
    <template>
        <iron-ajax id="getCart"></iron-ajax>
        <iron-ajax id="clearCart"></iron-ajax>
        <iron-ajax id="addToCart"></iron-ajax>
        <iron-ajax id="removeFromCart"></iron-ajax>
        <iron-ajax id="createOrder"></iron-ajax>

    </template>

    <script>
        /**
         * `oc-cart-api`
         * Ordercloud Cart Api calls
         *
         * @customElement
         * @polymer
         * @demo demo/index.html
         */


        class OcCartApi extends Ordercloud.ApiMixin(Polymer.Element) {
            static get is() { return 'oc-cart-api'; }
            static get behaviours() {}

            getCart(userId) {
                this.$.getCart.url = this._generateUrl('cart/user/'+ userId);
                return this._generateRequest(this.$.getCart);
            }
            /**
             * Clear a users cart
             * @param {Number} userId The ID of the logged in user
             * @return {Promise}
             */
            clearCart(userId) {
                this.$.clearCart.url = this._generateUrl('cart/user/' + userId);
                this.$.clearCart.method = "DELETE";
                this.$.clearCart.contentType = "application/json";
                return this._generateRequest(this.$.clearCart);
            }

            /**
             * Add items to users cart
             * @param {Number} userId The ID of the logged in user
             * @param {Object} details
             * @return {Promise}
             */
            addToCart(userId, details) {
                this.$.addToCart.url = this._generateUrl('cart/user/'+userId );
                this.$.addToCart.method = "PUT";
                this.$.addToCart.contentType = "application/json";
                this.$.addToCart.body = details;
                return this._generateRequest(this.$.addToCart);
            }

            /**
             * Removes an item from a users cart
             * @param {Number} userId The ID of the logged in user
             * @param {String} itemHash
             * @return {Promise}
             */
            removeFromCart(userId, itemHash) {
                this.$.removeFromCart.url = this._generateUrl('cart/user/' + userId + '/item/' + itemHash);
                this.$.removeFromCart.method = "DELETE";
                return this._generateRequest(this.$.removeFromCart);
            }

            /**
             * Creates an order from the users cart
             * @param {Number} userId The ID of the logged in user
             * @param {Object} details
             * @return {Promise}
             */
            createOrder(userId, details) {
                this.$.createOrder.url = this._generateUrl('cart/user/' + userId + '/order');
                this.$.createOrder.method = "POST";
                this.$.createOrder.contentType = "application/json";
                this.$.createOrder.body = details;
                return this._generateRequest(this.$.createOrder);
            }
        }

        window.customElements.define(OcCartApi.is, OcCartApi);
    </script>
</dom-module>
